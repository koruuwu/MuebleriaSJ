<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Usuario (Frontend)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="/Panel_PANTALLAS/cards.css">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .form-row {
      margin-bottom: 15px;
    }
    .form-row label {
      font-weight: bold;
    }
    .form-row input, .form-row select {
      padding: 10px;
      font-size: 1rem;
    }
    #formularios-especiales form input {
      margin-bottom: 15px;
    }
    #formularios-especiales form button {
      margin-top: 10px;
    }
    #add {
      background-color: #2d4363;
      color: white;
       border: none;
    }

    #add:hover {
      background-color: #435d83;
      color: white;
    }
  </style>
</head>

<body class="container py-4">
  <a href="#" class="btn btn-outline-secondary mb-4">Regresar al Panel Administrativo</a>
  <h2 class="mb-4">Crear Usuario</h2>

  <form id="form-usuario" class="mb-5 p-4 border rounded-3 bg-light">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">ID Usuario</label>
        <input type="text" name="id_usuario" class="form-control" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">Contraseña</label>
        <input type="password" name="contrasena" class="form-control" required>
      </div>
    </div>

    <div class="row g-3 mt-2">
      <div class="col-md-6">
        <label class="form-label">Tipo</label>
        <select class="form-select" name="tipo" id="tipo_usuario_select" required>
          <option>Vendedor</option>
          <option>Empleado</option>
          <option>Gerente compras</option>
          <option>Administrador</option>
        </select>
      </div>
    </div>

    <div class="row g-3 mt-3">
      <div class="col-md-12">
        <button type="submit" class="btn btn-primary w-100" id="add">Crear Usuario</button>
      </div>
    </div>
  </form>

  <div id="formularios-especiales"></div>
  <div id="mensaje" style="margin-top: 20px;"></div>

  <script>
    document.getElementById('form-usuario').addEventListener('submit', function (e) {
      e.preventDefault();

      const idUsuario = document.querySelector('[name="id_usuario"]').value;
      const tipoUsuario = document.getElementById('tipo_usuario_select').value;

      mostrarMensaje(`✅ Usuario "${idUsuario}" creado localmente (sin base de datos).`, true);

      // Mostrar formulario correspondiente
      cargarFormularioEspecial(idUsuario, tipoUsuario);

      // Desactivar botón para evitar recrear
      this.querySelector('button[type="submit"]').disabled = true;
    });

    function cargarFormularioEspecial(idUsuario, tipo) {
      const divFormularios = document.getElementById('formularios-especiales');
      divFormularios.innerHTML = ''; 

      if (tipo === 'Estudiante') {
        
      } else if (tipo === 'Administrador') {
  divFormularios.innerHTML = `
    <h3 class="mb-3">Registrar Administrativo</h3>
    <form id="form-administrativo">
      <input type="hidden" name="id_usuario" value="${idUsuario}">
      <input type="text" name="nombre" placeholder="Nombre" required class="form-control">
      <input type="text" name="dni" placeholder="DNI" required class="form-control">
      <input type="text" name="telefono" placeholder="Teléfono" required class="form-control">
      <input type="text" name="cargo" placeholder="Cargo" required class="form-control">
      <input type="text" name="departamento" placeholder="Departamento" required class="form-control">
      
      <!-- Aquí van los documentos -->
      <div class="mb-3">
  <label class="form-label">Documentos</label>
  <div id="documentos-container">
    <div class="d-flex mb-2 documento-row align-items-center">
      <select class="form-select me-2 documento-tipo" name="documento_tipo[]">
        <option value="Pasaporte">Pasaporte</option>
        <option value="ID">ID</option>
        <option value="Partida Nacimiento">Partida de Nacimiento</option>
      </select>
      <input type="text" name="documento_valor[]" placeholder="Valor" class="form-control me-2 documento-valor">
      <button type="button" id="add" class="btn btn-success btn-add">+</button>
    </div>
  </div>
</div>

      <button type="submit" id="add" class="btn btn-success w-100">Guardar Administrativo</button>
    </form>
  `;
  prepararEnvio('form-administrativo');
}
    }

    function prepararEnvio(formId) {
      document.getElementById(formId).addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        const datos = {};
        for (let [k, v] of formData.entries()) datos[k] = v;

        mostrarMensaje(`Datos de ${formId.replace('form-', '')} guardados localmente:\n` + JSON.stringify(datos, null, 2), true);
      });
    }

    function mostrarMensaje(mensaje, esExito) {
      const mensajeDiv = document.getElementById('mensaje');
      mensajeDiv.innerHTML = `<pre>${mensaje}</pre>`;
      mensajeDiv.className = esExito ? 'alert alert-success' : 'alert alert-danger';
      mensajeDiv.style.display = 'block';
    }
    document.addEventListener('click', function(e) {
  if (e.target && e.target.classList.contains('btn-add')) {
    const row = e.target.closest('.documento-row');
    const clone = row.cloneNode(true);
    clone.querySelector('input').value = ''; // limpiar valor
    row.after(clone);
  }
});
  </script>
</body>
</html>
